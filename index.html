<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="HM TCG Sales ‚Äì Buy Pok√©mon Trading Cards online. Browse singles, booster packs, and sealed product at great prices.">
<meta name="keywords" content="Pokemon TCG, Pokemon cards, trading cards, buy Pokemon cards, HM TCG Sales, booster packs, singles">
<meta property="og:title" content="HM TCG Sales ‚Äì Pok√©mon Trading Cards">
<meta property="og:description" content="Your #1 destination for Pok√©mon TCG singles, packs, and sealed product.">
<title>HM TCG Sales ‚Äì Pok√©mon Trading Cards</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --red: #e3000b;
    --yellow: #f5d800;
    --dark: #0e0e14;
    --card-bg: #1a1a26;
    --surface: #22222f;
    --border: #2e2e40;
    --text: #f0f0f8;
    --muted: #888899;
    --accent: #3db8f5;
    --success: #22c55e;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--dark);
    color: var(--text);
    font-family: 'Nunito', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* HEADER */
  header {
    background: linear-gradient(135deg, #0e0e14 0%, #1a1020 50%, #0e0e14 100%);
    border-bottom: 3px solid var(--red);
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: 0 4px 30px rgba(227,0,11,0.3);
  }

  .header-inner {
    max-width: 1300px;
    margin: 0 auto;
    padding: 0 24px;
    display: flex;
    align-items: center;
    gap: 24px;
    height: 72px;
  }

  .logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2rem;
    letter-spacing: 2px;
    color: var(--yellow);
    text-shadow: 0 0 20px rgba(245,216,0,0.5);
    white-space: nowrap;
    flex-shrink: 0;
    cursor: pointer;
  }
  .logo span { color: var(--red); }

  .search-bar {
    flex: 1;
    position: relative;
  }
  .search-bar input {
    width: 100%;
    padding: 10px 44px 10px 16px;
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'Nunito', sans-serif;
    font-size: 0.95rem;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .search-bar input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(61,184,245,0.15);
  }
  .search-bar input::placeholder { color: var(--muted); }
  .search-icon {
    position: absolute;
    right: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    font-size: 1.1rem;
    pointer-events: none;
  }

  .cart-btn {
    background: var(--red);
    border: none;
    border-radius: 10px;
    padding: 10px 20px;
    color: white;
    font-family: 'Nunito', sans-serif;
    font-weight: 800;
    font-size: 0.95rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background 0.2s, transform 0.1s;
    flex-shrink: 0;
    white-space: nowrap;
  }
  .cart-btn:hover { background: #c0000a; transform: translateY(-1px); }
  .cart-count {
    background: var(--yellow);
    color: var(--dark);
    border-radius: 50%;
    width: 22px;
    height: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    font-weight: 800;
    transition: transform 0.3s;
  }
  .cart-count.bump { animation: bump 0.3s ease; }
  @keyframes bump { 0%,100%{transform:scale(1)} 50%{transform:scale(1.4)} }

  /* HERO */
  .hero {
    background: linear-gradient(135deg, #0e0e14 0%, #180818 40%, #101828 100%);
    padding: 60px 24px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .hero::before {
    content: '‚ö°';
    position: absolute;
    font-size: 300px;
    opacity: 0.03;
    top: -60px;
    left: -40px;
    pointer-events: none;
  }
  .hero::after {
    content: 'üî•';
    position: absolute;
    font-size: 200px;
    opacity: 0.03;
    bottom: -40px;
    right: -20px;
    pointer-events: none;
  }
  .hero h1 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(2.5rem, 6vw, 4.5rem);
    letter-spacing: 4px;
    color: var(--yellow);
    text-shadow: 0 0 40px rgba(245,216,0,0.4);
    line-height: 1;
  }
  .hero p {
    color: var(--muted);
    margin-top: 12px;
    font-size: 1.1rem;
    font-weight: 600;
  }
  .hero-badges {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-top: 20px;
    flex-wrap: wrap;
  }
  .badge {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 6px 16px;
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--accent);
  }

  /* FILTERS */
  .filters {
    max-width: 1300px;
    margin: 32px auto 0;
    padding: 0 24px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    align-items: center;
  }
  .filter-label { color: var(--muted); font-weight: 700; font-size: 0.9rem; }
  .filter-btn {
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 7px 16px;
    color: var(--text);
    font-family: 'Nunito', sans-serif;
    font-weight: 700;
    font-size: 0.88rem;
    cursor: pointer;
    transition: all 0.15s;
  }
  .filter-btn:hover, .filter-btn.active {
    background: var(--red);
    border-color: var(--red);
    color: white;
  }

  /* GRID */
  .grid-section {
    max-width: 1300px;
    margin: 28px auto 60px;
    padding: 0 24px;
  }
  .section-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.8rem;
    letter-spacing: 2px;
    color: var(--yellow);
    margin-bottom: 20px;
  }
  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 20px;
  }

  /* PRODUCT CARD */
  .product-card {
    background: var(--card-bg);
    border: 1.5px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
    cursor: pointer;
    position: relative;
  }
  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 40px rgba(0,0,0,0.4);
    border-color: var(--accent);
  }
  .card-img-wrap {
    width: 100%;
    aspect-ratio: 3/4;
    position: relative;
    overflow: hidden;
    background: #111118;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .card-photo {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s;
    display: block;
  }
  .pack-photo {
    object-fit: contain;
    padding: 16px;
    background: linear-gradient(135deg, #1a1a30, #0e0e20);
  }
  .product-card:hover .card-photo { transform: scale(1.04); }
  .card-img-wrap::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, transparent 55%, rgba(0,0,0,0.55));
    pointer-events: none;
  }
  .rarity-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(0,0,0,0.7);
    border-radius: 6px;
    padding: 3px 8px;
    font-size: 0.7rem;
    font-weight: 800;
    z-index: 2;
  }
  .rarity-common { color: #aaa; }
  .rarity-uncommon { color: #22c55e; }
  .rarity-rare { color: #3db8f5; }
  .rarity-holo { color: var(--yellow); }
  .rarity-ex { color: #f472b6; }
  .rarity-ultra { color: #a78bfa; }

  .card-body { padding: 14px 16px 16px; }
  .card-set { font-size: 0.72rem; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; }
  .card-name { font-weight: 800; font-size: 1rem; line-height: 1.2; margin-bottom: 2px; }
  .card-condition { font-size: 0.78rem; color: var(--muted); margin-bottom: 4px; }
  .card-desc { font-size: 0.74rem; color: var(--muted); margin-bottom: 10px; line-height: 1.4; }
  .card-footer { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
  .card-price { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; color: var(--yellow); letter-spacing: 1px; }
  .add-btn {
    background: var(--red);
    border: none;
    border-radius: 8px;
    color: white;
    font-family: 'Nunito', sans-serif;
    font-weight: 800;
    font-size: 0.82rem;
    padding: 7px 13px;
    cursor: pointer;
    transition: background 0.15s, transform 0.1s;
  }
  .add-btn:hover { background: #c0000a; transform: scale(1.05); }
  .add-btn.added { background: var(--success); }

  .no-results {
    grid-column: 1 / -1;
    text-align: center;
    padding: 60px;
    color: var(--muted);
  }
  .no-results span { font-size: 3rem; display: block; margin-bottom: 12px; }

  /* BASKET PANEL */
  .basket-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    z-index: 2000;
    backdrop-filter: blur(4px);
  }
  .basket-overlay.open { display: block; animation: fadeIn 0.2s; }
  @keyframes fadeIn { from{opacity:0} to{opacity:1} }

  .basket-panel {
    position: fixed;
    right: 0;
    top: 0;
    bottom: 0;
    width: min(440px, 100vw);
    background: var(--card-bg);
    border-left: 2px solid var(--border);
    z-index: 2001;
    display: flex;
    flex-direction: column;
    transform: translateX(100%);
    transition: transform 0.3s cubic-bezier(0.4,0,0.2,1);
  }
  .basket-panel.open { transform: translateX(0); }

  .basket-header {
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .basket-header h2 { font-family: 'Bebas Neue', sans-serif; font-size: 1.6rem; letter-spacing: 2px; color: var(--yellow); }
  .close-btn { background: none; border: none; color: var(--muted); font-size: 1.5rem; cursor: pointer; padding: 4px; line-height: 1; }
  .close-btn:hover { color: var(--text); }

  .basket-items { flex: 1; overflow-y: auto; padding: 16px; }
  .basket-empty { text-align: center; padding: 60px 20px; color: var(--muted); }
  .basket-empty span { font-size: 3rem; display: block; margin-bottom: 12px; }

  .basket-item {
    display: flex;
    gap: 12px;
    padding: 12px;
    background: var(--surface);
    border-radius: 10px;
    margin-bottom: 10px;
    align-items: center;
  }
  .basket-item-img {
    width: 52px;
    height: 70px;
    object-fit: cover;
    border-radius: 6px;
    flex-shrink: 0;
    background: #111;
  }
  .basket-item-img.pack-img { object-fit: contain; background: #1a1a30; padding: 4px; }
  .basket-item-info { flex: 1; }
  .basket-item-name { font-weight: 800; font-size: 0.9rem; }
  .basket-item-set { font-size: 0.75rem; color: var(--muted); }
  .basket-item-price { color: var(--yellow); font-weight: 800; font-size: 0.9rem; }
  .qty-controls { display: flex; align-items: center; gap: 6px; }
  .qty-btn { background: var(--border); border: none; border-radius: 5px; color: var(--text); width: 26px; height: 26px; cursor: pointer; font-size: 1rem; font-weight: 700; transition: background 0.15s; }
  .qty-btn:hover { background: var(--red); }
  .qty-num { font-weight: 800; min-width: 20px; text-align: center; font-size: 0.9rem; }
  .remove-item { background: none; border: none; color: var(--muted); cursor: pointer; font-size: 1.1rem; padding: 4px; transition: color 0.15s; }
  .remove-item:hover { color: var(--red); }

  .basket-footer {
    padding: 20px 24px;
    border-top: 1px solid var(--border);
  }
  .basket-subtotal { display: flex; justify-content: space-between; margin-bottom: 8px; }
  .basket-subtotal span { color: var(--muted); font-weight: 700; }
  .basket-subtotal strong { font-family: 'Bebas Neue', sans-serif; font-size: 1.4rem; color: var(--yellow); }
  .basket-shipping { font-size: 0.8rem; color: var(--muted); margin-bottom: 16px; text-align: right; }
  .checkout-btn {
    width: 100%;
    background: var(--red);
    border: none;
    border-radius: 12px;
    color: white;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.4rem;
    letter-spacing: 2px;
    padding: 14px;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
  }
  .checkout-btn:hover { background: #c0000a; transform: translateY(-1px); }
  .checkout-btn:disabled { background: var(--border); color: var(--muted); cursor: not-allowed; transform: none; }

  /* CHECKOUT MODAL */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 3000;
    backdrop-filter: blur(6px);
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .modal-overlay.open { display: flex; animation: fadeIn 0.2s; }
  .modal {
    background: var(--card-bg);
    border: 1.5px solid var(--border);
    border-radius: 20px;
    width: 100%;
    max-width: 560px;
    max-height: 90vh;
    overflow-y: auto;
    animation: slideUp 0.3s;
  }
  @keyframes slideUp { from{transform:translateY(30px);opacity:0} to{transform:translateY(0);opacity:1} }

  .modal-header {
    padding: 24px 28px 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .modal-header h2 { font-family: 'Bebas Neue', sans-serif; font-size: 1.8rem; letter-spacing: 2px; color: var(--yellow); }
  .modal-body { padding: 20px 28px 28px; }

  /* STEPPER */
  .stepper { display: flex; gap: 0; margin-bottom: 28px; }
  .step {
    flex: 1;
    text-align: center;
    padding: 10px 4px;
    font-size: 0.78rem;
    font-weight: 800;
    color: var(--muted);
    border-bottom: 3px solid var(--border);
    transition: all 0.2s;
  }
  .step.active { color: var(--accent); border-color: var(--accent); }
  .step.done { color: var(--success); border-color: var(--success); }
  .step-num { display: block; font-size: 1rem; margin-bottom: 2px; }

  /* FORM */
  .form-section { margin-bottom: 20px; }
  .form-section h3 { font-weight: 800; font-size: 1rem; margin-bottom: 12px; color: var(--text); }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .form-group { display: flex; flex-direction: column; gap: 5px; margin-bottom: 12px; }
  .form-group label { font-size: 0.8rem; font-weight: 700; color: var(--muted); }
  .form-group input, .form-group select {
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    color: var(--text);
    font-family: 'Nunito', sans-serif;
    font-size: 0.9rem;
    transition: border-color 0.2s;
    width: 100%;
  }
  .form-group input:focus, .form-group select:focus {
    outline: none;
    border-color: var(--accent);
  }
  .form-group input::placeholder { color: var(--muted); }
  .form-group select option { background: var(--card-bg); }

  .card-icons { display: flex; gap: 8px; margin-top: 6px; }
  .card-icon { background: var(--surface); border: 1px solid var(--border); border-radius: 4px; padding: 3px 8px; font-size: 0.75rem; font-weight: 700; color: var(--muted); }

  .order-summary {
    background: var(--surface);
    border-radius: 10px;
    padding: 16px;
    margin-bottom: 20px;
  }
  .order-summary h3 { font-weight: 800; margin-bottom: 12px; font-size: 0.95rem; }
  .summary-row { display: flex; justify-content: space-between; font-size: 0.88rem; margin-bottom: 6px; }
  .summary-row span { color: var(--muted); }
  .summary-total { display: flex; justify-content: space-between; border-top: 1px solid var(--border); margin-top: 10px; padding-top: 10px; }
  .summary-total span { font-weight: 800; }
  .summary-total strong { font-family: 'Bebas Neue', sans-serif; font-size: 1.4rem; color: var(--yellow); }

  .modal-actions { display: flex; gap: 12px; }
  .btn-back {
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'Nunito', sans-serif;
    font-weight: 800;
    font-size: 0.9rem;
    padding: 12px 20px;
    cursor: pointer;
    transition: all 0.15s;
  }
  .btn-back:hover { border-color: var(--accent); color: var(--accent); }
  .btn-next {
    flex: 1;
    background: var(--red);
    border: none;
    border-radius: 10px;
    color: white;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.2rem;
    letter-spacing: 1px;
    padding: 12px;
    cursor: pointer;
    transition: background 0.15s, transform 0.1s;
  }
  .btn-next:hover { background: #c0000a; transform: translateY(-1px); }

  /* SUCCESS */
  .success-screen {
    text-align: center;
    padding: 20px 0;
  }
  .success-icon { font-size: 4rem; margin-bottom: 16px; }
  .success-screen h2 { font-family: 'Bebas Neue', sans-serif; font-size: 2rem; letter-spacing: 2px; color: var(--success); margin-bottom: 8px; }
  .success-screen p { color: var(--muted); font-size: 0.95rem; line-height: 1.6; }
  .order-ref { background: var(--surface); border-radius: 8px; padding: 12px 20px; margin: 16px 0; font-weight: 800; color: var(--accent); letter-spacing: 2px; font-size: 1.1rem; }

  /* FOOTER */
  footer {
    background: var(--surface);
    border-top: 2px solid var(--border);
    padding: 32px 24px;
    text-align: center;
    color: var(--muted);
    font-size: 0.85rem;
  }
  footer strong { color: var(--yellow); }

  @media (max-width: 600px) {
    .form-row { grid-template-columns: 1fr; }
    .header-inner { gap: 12px; }
    .logo { font-size: 1.5rem; }
  }
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="header-inner">
    <div class="logo" onclick="showAll()">HM <span>TCG</span> SALES</div>
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search cards, sets, Pok√©mon..." oninput="filterCards()" aria-label="Search cards">
      <span class="search-icon">üîç</span>
    </div>
    <button class="cart-btn" onclick="openBasket()">
      üõí Basket
      <span class="cart-count" id="cartCount">0</span>
    </button>
  </div>
</header>

<!-- HERO -->
<div class="hero">
  <h1>Pok√©mon TCG Store</h1>
  <p>Rare singles ¬∑ Booster packs ¬∑ Sealed product ¬∑ Fast UK shipping</p>
  <div class="hero-badges">
    <span class="badge">‚úì Authentic Cards</span>
    <span class="badge">üì¶ Fast Dispatch</span>
    <span class="badge">‚≠ê Top-Rated Seller</span>
    <span class="badge">üîÑ Easy Returns</span>
  </div>
</div>

<!-- FILTERS -->
<div class="filters">
  <span class="filter-label">Filter:</span>
  <button class="filter-btn active" onclick="setFilter('all', this)">All</button>
  <button class="filter-btn" onclick="setFilter('singles', this)">Singles</button>
  <button class="filter-btn" onclick="setFilter('packs', this)">Booster Packs</button>
  <button class="filter-btn" onclick="setFilter('sealed', this)">Sealed</button>
  <button class="filter-btn" onclick="setFilter('classic', this)">Classic Era</button>
</div>

<!-- PRODUCT GRID -->
<div class="grid-section">
  <div class="section-title">üì¶ Shop All Products</div>
  <div class="card-grid" id="cardGrid"></div>
</div>

<!-- FOOTER -->
<footer>
  <strong>HM TCG Sales</strong> ¬∑ Pok√©mon Trading Cards ¬∑ All cards are genuine and handled with care<br>
  <span style="margin-top:6px;display:block">¬© 2025 HM TCG Sales. Pok√©mon is a trademark of Nintendo / Creatures Inc. / GAME FREAK Inc.</span>
</footer>

<!-- BASKET PANEL -->
<div class="basket-overlay" id="basketOverlay" onclick="closeBasket()"></div>
<div class="basket-panel" id="basketPanel">
  <div class="basket-header">
    <h2>üõí Your Basket</h2>
    <button class="close-btn" onclick="closeBasket()">‚úï</button>
  </div>
  <div class="basket-items" id="basketItems"></div>
  <div class="basket-footer">
    <div class="basket-subtotal">
      <span>Subtotal</span>
      <strong id="basketTotal">¬£0.00</strong>
    </div>
    <div class="basket-shipping" id="shippingNote">Add ¬£2.99 more for free shipping!</div>
    <button class="checkout-btn" id="checkoutBtn" onclick="openCheckout()">PROCEED TO CHECKOUT ‚Üí</button>
  </div>
</div>

<!-- CHECKOUT MODAL -->
<div class="modal-overlay" id="checkoutModal">
  <div class="modal">
    <div class="modal-header">
      <h2 id="modalTitle">Checkout</h2>
      <button class="close-btn" onclick="closeCheckout()">‚úï</button>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<script>
// =========================================
// PRODUCT DATA
// Singles prices sourced from TCGPlayer via PokemonWizard (live 22 Feb 2026)
// Converted USD ‚Üí GBP at 0.80. Sealed from UK retailer averages.
// =========================================
const products = [
  // ‚îÄ‚îÄ MODERN SINGLES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  {
    id: 1,
    name: "Charizard ex ‚Äî Special Illustration Rare",
    set: "Scarlet & Violet: 151", condition: "Near Mint",
    // TCGPlayer: $297.70 today (22 Feb 2026) ‚Üí ¬£238
    price: 238.00, rarity: "ex", rarityLabel: "Spec. Illus. Rare", category: "singles",
    img: "https://images.pokemontcg.io/sv3pt5/199.png",
    desc: "199/165 ¬∑ TCGPlayer $297.70 (22 Feb 26) ¬∑ Up 15% in 30 days ¬∑ Top chase card of the modern era"
  },
  {
    id: 2,
    name: "Charizard ex ‚Äî Full Art Ultra Rare",
    set: "Scarlet & Violet: 151", condition: "Near Mint",
    // TCGPlayer: $39.78 today ‚Üí ¬£32
    price: 31.99, rarity: "ex", rarityLabel: "Full Art Ultra Rare", category: "singles",
    img: "https://images.pokemontcg.io/sv3pt5/183.png",
    desc: "183/165 ¬∑ TCGPlayer $39.78 (22 Feb 26) ¬∑ Up 45% YTD ‚Äî rising fast"
  },
  {
    id: 3,
    name: "Mewtwo ex ‚Äî Full Art Ultra Rare",
    set: "Scarlet & Violet: 151", condition: "Near Mint",
    // TCGPlayer: ~$24 ‚Üí ¬£19
    price: 18.99, rarity: "ex", rarityLabel: "Full Art Ultra Rare", category: "singles",
    img: "https://images.pokemontcg.io/sv3pt5/205.png",
    desc: "205/165 ¬∑ TCGPlayer ~$24 ¬∑ Full Art Ultra Rare Psychic powerhouse"
  },
  {
    id: 4,
    name: "Umbreon VMAX ‚Äî Alternate Art Secret",
    set: "Evolving Skies", condition: "Near Mint",
    // TCGPlayer: $1,789.97 (Jan 2026) ‚Üí ¬£1,432 ‚Äî the raw NM price
    price: 1432.00, rarity: "ultra", rarityLabel: "Alt Art Secret Rare", category: "singles",
    img: "https://images.pokemontcg.io/swsh7/215.png",
    desc: "215/203 ¬∑ TCGPlayer $1,789.97 (Jan 26) ¬∑ 'Moonbreon' ‚Äî the most iconic modern Pok√©mon card"
  },
  {
    id: 5,
    name: "Rayquaza VMAX ‚Äî Alternate Art Secret",
    set: "Evolving Skies", condition: "Near Mint",
    // TCGPlayer: $655.34 today ‚Üí ¬£524
    price: 524.00, rarity: "ultra", rarityLabel: "Alt Art Secret Rare", category: "singles",
    img: "https://images.pokemontcg.io/swsh7/218.png",
    desc: "218/203 ¬∑ TCGPlayer $655.34 (22 Feb 26) ¬∑ Crown jewel dragon card"
  },
  {
    id: 6,
    name: "Pikachu VMAX ‚Äî Rainbow Rare",
    set: "Vivid Voltage", condition: "Near Mint",
    // TCGPlayer: ~$35 ‚Üí ¬£28
    price: 27.99, rarity: "ultra", rarityLabel: "Rainbow Rare", category: "singles",
    img: "https://images.pokemontcg.io/swsh4/188.png",
    desc: "188/185 ¬∑ TCGPlayer ~$35 ¬∑ Rainbow Secret Rare Pikachu VMAX"
  },
  {
    id: 7,
    name: "Gardevoir ex ‚Äî Special Illustration Rare",
    set: "Scarlet & Violet Base Set", condition: "Near Mint",
    // TCGPlayer: ~$22 ‚Üí ¬£18
    price: 17.99, rarity: "ex", rarityLabel: "Spec. Illus. Rare", category: "singles",
    img: "https://images.pokemontcg.io/sv1/245.png",
    desc: "245/198 ¬∑ TCGPlayer ~$22 ¬∑ Top competitive SIR from the base SV set"
  },
  {
    id: 8,
    name: "Lugia V ‚Äî Alternate Art",
    set: "Silver Tempest", condition: "Near Mint",
    // TCGPlayer: ~$20 ‚Üí ¬£16
    price: 15.99, rarity: "holo", rarityLabel: "Alt Art Ultra Rare", category: "singles",
    img: "https://images.pokemontcg.io/swsh12/186.png",
    desc: "186/195 ¬∑ TCGPlayer ~$20 ¬∑ Beautiful soaring Lugia alternate art"
  },
  {
    id: 9,
    name: "Mew ex ‚Äî Full Art",
    set: "Scarlet & Violet: 151", condition: "Near Mint",
    // TCGPlayer: ~$15 ‚Üí ¬£12
    price: 11.99, rarity: "ex", rarityLabel: "Full Art Ultra Rare", category: "singles",
    img: "https://images.pokemontcg.io/sv3pt5/232.png",
    desc: "232/165 ¬∑ TCGPlayer ~$15 ¬∑ The set's namesake Pok√©mon in watercolour art"
  },
  {
    id: 10,
    name: "Gengar ex ‚Äî Full Art",
    set: "Scarlet & Violet: 151", condition: "Near Mint",
    // TCGPlayer: ~$10 ‚Üí ¬£8
    price: 7.99, rarity: "ex", rarityLabel: "Full Art Ultra Rare", category: "singles",
    img: "https://images.pokemontcg.io/sv3pt5/197.png",
    desc: "197/165 ¬∑ TCGPlayer ~$10 ¬∑ Fan-favourite Ghost-type full art"
  },

  // ‚îÄ‚îÄ CLASSIC SINGLES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  {
    id: 11,
    name: "Charizard ‚Äî Holo Rare",
    set: "Base Set (1999) Unlimited", condition: "Good",
    // TCGPlayer Good condition: ~$400 ‚Üí ¬£320
    price: 319.99, rarity: "holo", rarityLabel: "Holo Rare", category: "singles classic",
    img: "https://images.pokemontcg.io/base1/4.png",
    desc: "4/102 ¬∑ TCGPlayer ~$400 (Good) ¬∑ The original 1999 holy grail of Pok√©mon"
  },
  {
    id: 12,
    name: "Blastoise ‚Äî Holo Rare",
    set: "Base Set (1999) Unlimited", condition: "Good",
    // TCGPlayer Good: ~$70 ‚Üí ¬£56
    price: 55.99, rarity: "holo", rarityLabel: "Holo Rare", category: "singles classic",
    img: "https://images.pokemontcg.io/base1/2.png",
    desc: "2/102 ¬∑ TCGPlayer ~$70 (Good) ¬∑ Original Base Set Water-type powerhouse"
  },
  {
    id: 13,
    name: "Venusaur ‚Äî Holo Rare",
    set: "Base Set (1999) Unlimited", condition: "Good",
    // TCGPlayer Good: ~$50 ‚Üí ¬£40
    price: 39.99, rarity: "holo", rarityLabel: "Holo Rare", category: "singles classic",
    img: "https://images.pokemontcg.io/base1/15.png",
    desc: "15/102 ¬∑ TCGPlayer ~$50 (Good) ¬∑ Classic Grass starter from the original Base Set"
  },
  {
    id: 14,
    name: "Mewtwo ‚Äî Holo Rare",
    set: "Base Set (1999) Unlimited", condition: "Good",
    // TCGPlayer Good: ~$35 ‚Üí ¬£28
    price: 27.99, rarity: "holo", rarityLabel: "Holo Rare", category: "singles classic",
    img: "https://images.pokemontcg.io/base1/10.png",
    desc: "10/102 ¬∑ TCGPlayer ~$35 (Good) ¬∑ Iconic original Base Set Psychic-type"
  },
  {
    id: 15,
    name: "Lugia ‚Äî Holo Rare",
    set: "Neo Genesis (2000)", condition: "Lightly Played",
    // TCGPlayer LP: ~$55 ‚Üí ¬£44
    price: 43.99, rarity: "holo", rarityLabel: "Holo Rare", category: "singles classic",
    img: "https://images.pokemontcg.io/neo1/9.png",
    desc: "9/111 ¬∑ TCGPlayer ~$55 (LP) ¬∑ Classic silver-wing legendary from Neo Genesis"
  },

  // ‚îÄ‚îÄ BOOSTER PACKS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  {
    id: 16,
    name: "Scarlet & Violet 151 Booster Pack",
    set: "Scarlet & Violet (Sep 2023)", condition: "Factory Sealed",
    price: 5.99, rarity: "common", rarityLabel: "Booster Pack", category: "packs",
    img: "https://images.pokemontcg.io/sv3pt5/logo.png", packImg: true,
    desc: "10 cards per pack ¬∑ Chase: Charizard ex SIR, Mewtwo ex, Mew ex ¬∑ Most popular modern set"
  },
  {
    id: 17,
    name: "Obsidian Flames Booster Pack",
    set: "Scarlet & Violet (Aug 2023)", condition: "Factory Sealed",
    price: 4.49, rarity: "common", rarityLabel: "Booster Pack", category: "packs",
    img: "https://images.pokemontcg.io/sv3/logo.png", packImg: true,
    desc: "10 cards per pack ¬∑ Chase: Tera Charizard ex (Obsidian), Tyranitar ex SIR"
  },
  {
    id: 18,
    name: "Paradox Rift Booster Pack",
    set: "Scarlet & Violet (Nov 2023)", condition: "Factory Sealed",
    price: 4.49, rarity: "common", rarityLabel: "Booster Pack", category: "packs",
    img: "https://images.pokemontcg.io/sv4/logo.png", packImg: true,
    desc: "10 cards per pack ¬∑ Chase: Roaring Moon ex, Iron Valiant ex"
  },
  {
    id: 19,
    name: "Surging Sparks Booster Pack",
    set: "Scarlet & Violet (Nov 2024)", condition: "Factory Sealed",
    price: 4.99, rarity: "common", rarityLabel: "Booster Pack", category: "packs",
    img: "https://images.pokemontcg.io/sv8/logo.png", packImg: true,
    desc: "10 cards per pack ¬∑ Chase: Pikachu ex SIR ‚Äî Pikachu-themed set"
  },
  {
    id: 20,
    name: "Evolving Skies Booster Pack",
    set: "Sword & Shield (Aug 2021)", condition: "Factory Sealed",
    price: 11.99, rarity: "common", rarityLabel: "Booster Pack", category: "packs",
    img: "https://images.pokemontcg.io/swsh7/logo.png", packImg: true,
    desc: "10 cards per pack ¬∑ Out-of-print premium ¬∑ Chase: Umbreon VMAX Alt Art (¬£1,432), Rayquaza VMAX Alt Art (¬£524)"
  },

  // ‚îÄ‚îÄ SEALED PRODUCT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  {
    id: 21,
    name: "Scarlet & Violet 151 ‚Äî Elite Trainer Box",
    set: "Elite Trainer Box (2023)", condition: "Factory Sealed",
    price: 64.99, rarity: "holo", rarityLabel: "Elite Trainer Box", category: "sealed",
    img: "https://images.pokemontcg.io/sv3pt5/logo.png", packImg: true,
    desc: "9 packs + Snorlax promo, 65 sleeves, dice & accessories ¬∑ Most popular modern ETB"
  },
  {
    id: 22,
    name: "Obsidian Flames ‚Äî Elite Trainer Box",
    set: "Elite Trainer Box (2023)", condition: "Factory Sealed",
    price: 44.99, rarity: "holo", rarityLabel: "Elite Trainer Box", category: "sealed",
    img: "https://images.pokemontcg.io/sv3/logo.png", packImg: true,
    desc: "9 packs + Charizard promo card, 65 sleeves, dice & accessories"
  },
  {
    id: 23,
    name: "Surging Sparks ‚Äî Elite Trainer Box",
    set: "Elite Trainer Box (2024)", condition: "Factory Sealed",
    price: 44.99, rarity: "holo", rarityLabel: "Elite Trainer Box", category: "sealed",
    img: "https://images.pokemontcg.io/sv8/logo.png", packImg: true,
    desc: "9 packs + Pikachu-themed accessories ¬∑ Latest Scarlet & Violet ETB"
  },
  {
    id: 24,
    name: "Paldean Fates ‚Äî Elite Trainer Box",
    set: "Elite Trainer Box (2024)", condition: "Factory Sealed",
    price: 59.99, rarity: "holo", rarityLabel: "Elite Trainer Box", category: "sealed",
    img: "https://images.pokemontcg.io/sv4pt5/logo.png", packImg: true,
    desc: "9 packs + Shiny Mimikyu promo ¬∑ Features Shiny Charizard ex SIR chase card"
  },
];

let cart = {};
let currentFilter = 'all';
let searchQuery = '';

// =========================================
// RENDER CARDS
// =========================================
function renderCards() {
  const grid = document.getElementById('cardGrid');
  let filtered = products.filter(p => {
    const matchFilter = currentFilter === 'all' || p.category.includes(currentFilter);
    const q = searchQuery.toLowerCase();
    const matchSearch = !q || p.name.toLowerCase().includes(q) || p.set.toLowerCase().includes(q) || p.category.toLowerCase().includes(q);
    return matchFilter && matchSearch;
  });

  if (!filtered.length) {
    grid.innerHTML = `<div class="no-results"><span>üîç</span>No cards found for "${searchQuery}"<br><small style="margin-top:8px;display:block">Try searching by name or set</small></div>`;
    return;
  }

  grid.innerHTML = filtered.map(p => `
    <div class="product-card">
      <div class="card-img-wrap">
        <img
          src="${p.img}"
          alt="${p.name}"
          class="card-photo ${p.packImg ? 'pack-photo' : ''}"
          onerror="this.onerror=null;this.src='https://images.pokemontcg.io/base1/4.png'"
          loading="lazy"
        >
        <span class="rarity-badge rarity-${p.rarity}">${p.rarityLabel}</span>
      </div>
      <div class="card-body">
        <div class="card-set">${p.set}</div>
        <div class="card-name">${p.name}</div>
        <div class="card-condition">${p.condition}</div>
        <div class="card-desc">${p.desc}</div>
        <div class="card-footer">
          <span class="card-price">¬£${p.price.toFixed(2)}</span>
          <button class="add-btn ${cart[p.id] ? 'added' : ''}" onclick="addToCart(event,${p.id})">
            ${cart[p.id] ? '‚úì Added' : '+ Add'}
          </button>
        </div>
      </div>
    </div>
  `).join('');
}

function setFilter(f, btn) {
  currentFilter = f;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderCards();
}

function filterCards() {
  searchQuery = document.getElementById('searchInput').value;
  renderCards();
}

function showAll() {
  searchQuery = '';
  document.getElementById('searchInput').value = '';
  currentFilter = 'all';
  document.querySelectorAll('.filter-btn').forEach((b,i) => b.classList.toggle('active', i===0));
  renderCards();
}

// =========================================
// CART
// =========================================
function addToCart(e, id) {
  e.stopPropagation();
  cart[id] = (cart[id] || 0) + 1;
  updateCartUI();
  renderCards();
  // Bump animation
  const cc = document.getElementById('cartCount');
  cc.classList.remove('bump');
  setTimeout(() => cc.classList.add('bump'), 10);
}

function quickAdd(id) {
  cart[id] = (cart[id] || 0) + 1;
  updateCartUI();
  renderCards();
}

function updateCartUI() {
  const total = Object.values(cart).reduce((a,b) => a+b, 0);
  document.getElementById('cartCount').textContent = total;
  const subtotal = getSubtotal();
  document.getElementById('basketTotal').textContent = `¬£${subtotal.toFixed(2)}`;
  const shipping = subtotal >= 35 ? 'Free shipping on this order!' : `Add ¬£${(35 - subtotal).toFixed(2)} more for free shipping!`;
  document.getElementById('shippingNote').textContent = shipping;
  document.getElementById('checkoutBtn').disabled = total === 0;
  renderBasket();
}

function getSubtotal() {
  return Object.entries(cart).reduce((sum, [id, qty]) => {
    const p = products.find(x => x.id == id);
    return sum + (p ? p.price * qty : 0);
  }, 0);
}

function renderBasket() {
  const container = document.getElementById('basketItems');
  const items = Object.entries(cart).filter(([,qty]) => qty > 0);
  if (!items.length) {
    container.innerHTML = '<div class="basket-empty"><span>üõí</span>Your basket is empty<br><small>Add some cards to get started!</small></div>';
    return;
  }
  container.innerHTML = items.map(([id, qty]) => {
    const p = products.find(x => x.id == id);
    if (!p) return '';
    return `
      <div class="basket-item">
        <img src="${p.img}" alt="${p.name}" class="basket-item-img ${p.packImg ? 'pack-img' : ''}" onerror="this.src='https://images.pokemontcg.io/base1/4.png'">
        <div class="basket-item-info">
          <div class="basket-item-name">${p.name}</div>
          <div class="basket-item-set">${p.set} ¬∑ ${p.condition}</div>
          <div class="basket-item-price">¬£${(p.price * qty).toFixed(2)}</div>
        </div>
        <div class="qty-controls">
          <button class="qty-btn" onclick="changeQty(${id},-1)">‚àí</button>
          <span class="qty-num">${qty}</span>
          <button class="qty-btn" onclick="changeQty(${id},1)">+</button>
        </div>
        <button class="remove-item" onclick="removeItem(${id})" title="Remove">üóë</button>
      </div>
    `;
  }).join('');
}

function changeQty(id, delta) {
  cart[id] = (cart[id] || 0) + delta;
  if (cart[id] <= 0) delete cart[id];
  updateCartUI();
  renderCards();
}

function removeItem(id) {
  delete cart[id];
  updateCartUI();
  renderCards();
}

// =========================================
// BASKET PANEL
// =========================================
function openBasket() {
  document.getElementById('basketOverlay').classList.add('open');
  document.getElementById('basketPanel').classList.add('open');
}
function closeBasket() {
  document.getElementById('basketOverlay').classList.remove('open');
  document.getElementById('basketPanel').classList.remove('open');
}

// =========================================
// CHECKOUT
// =========================================
let checkoutStep = 1;

function openCheckout() {
  checkoutStep = 1;
  closeBasket();
  renderCheckoutStep();
  document.getElementById('checkoutModal').classList.add('open');
}
function closeCheckout() {
  document.getElementById('checkoutModal').classList.remove('open');
}

function renderCheckoutStep() {
  const steps = ['Delivery', 'Payment', 'Review'];
  const title = document.getElementById('modalTitle');
  title.textContent = steps[checkoutStep-1];

  const stepper = `
    <div class="stepper">
      ${steps.map((s,i) => `<div class="step ${checkoutStep > i+1 ? 'done' : checkoutStep === i+1 ? 'active' : ''}"><span class="step-num">${checkoutStep > i+1 ? '‚úì' : i+1}</span>${s}</div>`).join('')}
    </div>
  `;

  const subtotal = getSubtotal();
  const shipping = subtotal >= 35 ? 0 : 2.99;
  const total = subtotal + shipping;

  let content = '';
  if (checkoutStep === 1) {
    content = `
      <div class="form-section">
        <h3>üìç Delivery Details</h3>
        <div class="form-row">
          <div class="form-group">
            <label>First Name</label>
            <input type="text" id="firstName" placeholder="John">
          </div>
          <div class="form-group">
            <label>Last Name</label>
            <input type="text" id="lastName" placeholder="Smith">
          </div>
        </div>
        <div class="form-group">
          <label>Email Address</label>
          <input type="email" id="email" placeholder="john@example.com">
        </div>
        <div class="form-group">
          <label>Phone Number</label>
          <input type="tel" id="phone" placeholder="07700 000000">
        </div>
        <div class="form-group">
          <label>Address Line 1</label>
          <input type="text" id="addr1" placeholder="123 Card Street">
        </div>
        <div class="form-group">
          <label>Address Line 2 (optional)</label>
          <input type="text" id="addr2" placeholder="Flat, building, etc.">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Town / City</label>
            <input type="text" id="city" placeholder="London">
          </div>
          <div class="form-group">
            <label>Postcode</label>
            <input type="text" id="postcode" placeholder="SW1A 1AA">
          </div>
        </div>
        <div class="form-group">
          <label>Shipping Method</label>
          <select id="shippingMethod">
            <option value="standard">Standard (3-5 days) ¬∑ ${shipping === 0 ? 'FREE' : '¬£2.99'}</option>
            <option value="tracked">Tracked (1-2 days) ¬∑ ¬£3.99</option>
            <option value="express">Express (Next Day) ¬∑ ¬£7.99</option>
          </select>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-next" style="width:100%" onclick="goStep(2)">CONTINUE TO PAYMENT ‚Üí</button>
      </div>
    `;
  } else if (checkoutStep === 2) {
    content = `
      <div class="form-section">
        <h3>üí≥ Payment Details</h3>
        <div class="card-icons">
          <span class="card-icon">VISA</span>
          <span class="card-icon">MC</span>
          <span class="card-icon">AMEX</span>
          <span class="card-icon">PayPal</span>
        </div>
        <br>
        <div class="form-group">
          <label>Name on Card</label>
          <input type="text" id="cardName" placeholder="John Smith">
        </div>
        <div class="form-group">
          <label>Card Number</label>
          <input type="text" id="cardNum" placeholder="1234 5678 9012 3456" maxlength="19" oninput="formatCard(this)">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Expiry Date</label>
            <input type="text" id="expiry" placeholder="MM/YY" maxlength="5" oninput="formatExpiry(this)">
          </div>
          <div class="form-group">
            <label>CVV</label>
            <input type="text" id="cvv" placeholder="123" maxlength="4">
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-back" onclick="goStep(1)">‚Üê Back</button>
        <button class="btn-next" onclick="goStep(3)">REVIEW ORDER ‚Üí</button>
      </div>
    `;
  } else if (checkoutStep === 3) {
    const items = Object.entries(cart);
    const itemSummary = items.map(([id, qty]) => {
      const p = products.find(x => x.id == id);
      return `<div class="summary-row"><span><img src="${p.img}" style="width:28px;height:36px;object-fit:${p.packImg?'contain':'cover'};border-radius:3px;vertical-align:middle;margin-right:6px">${p.name} √ó ${qty}</span><strong>¬£${(p.price*qty).toFixed(2)}</strong></div>`;
    }).join('');
    content = `
      <div class="order-summary">
        <h3>üõí Order Summary</h3>
        ${itemSummary}
        <div class="summary-row"><span>Shipping</span><strong>${shipping === 0 ? 'FREE' : '¬£'+shipping.toFixed(2)}</strong></div>
        <div class="summary-total"><span>Total</span><strong>¬£${total.toFixed(2)}</strong></div>
      </div>
      <p style="font-size:0.82rem;color:var(--muted);margin-bottom:16px;">By placing your order you agree to our terms and conditions. All orders are dispatched within 1-2 business days. Cards are packaged in protective sleeves and toploaders.</p>
      <div class="modal-actions">
        <button class="btn-back" onclick="goStep(2)">‚Üê Back</button>
        <button class="btn-next" onclick="placeOrder()">‚úì PLACE ORDER ¬∑ ¬£${total.toFixed(2)}</button>
      </div>
    `;
  }

  document.getElementById('modalBody').innerHTML = stepper + content;
}

function goStep(n) {
  if (n === 2) {
    const fn = document.getElementById('firstName')?.value;
    const email = document.getElementById('email')?.value;
    const addr = document.getElementById('addr1')?.value;
    const city = document.getElementById('city')?.value;
    const post = document.getElementById('postcode')?.value;
    if (!fn || !email || !addr || !city || !post) {
      alert('Please fill in all required delivery details.');
      return;
    }
  }
  if (n === 3) {
    const cn = document.getElementById('cardNum')?.value;
    const exp = document.getElementById('expiry')?.value;
    const cvv = document.getElementById('cvv')?.value;
    const cname = document.getElementById('cardName')?.value;
    if (!cn || !exp || !cvv || !cname) {
      alert('Please fill in all payment details.');
      return;
    }
  }
  checkoutStep = n;
  renderCheckoutStep();
}

function placeOrder() {
  const ref = 'HM' + Date.now().toString().slice(-6).toUpperCase();
  document.getElementById('modalTitle').textContent = 'Order Confirmed!';
  document.getElementById('modalBody').innerHTML = `
    <div class="success-screen">
      <div class="success-icon">üéâ</div>
      <h2>ORDER CONFIRMED!</h2>
      <p>Thank you for your order. We'll send a confirmation email shortly and your cards will be dispatched within 1-2 business days.</p>
      <div class="order-ref">Order Ref: ${ref}</div>
      <p>Cards are packaged in sleeves and toploaders for full protection üÉè</p>
      <br>
      <button class="btn-next" style="width:100%;margin-top:8px" onclick="finishOrder()">BACK TO SHOP</button>
    </div>
  `;
  cart = {};
  updateCartUI();
  renderCards();
}

function finishOrder() {
  closeCheckout();
}

function formatCard(input) {
  let v = input.value.replace(/\D/g, '').substring(0, 16);
  input.value = v.replace(/(.{4})/g, '$1 ').trim();
}
function formatExpiry(input) {
  let v = input.value.replace(/\D/g, '').substring(0, 4);
  if (v.length >= 3) v = v.substring(0,2) + '/' + v.substring(2);
  input.value = v;
}

// =========================================
// INIT
// =========================================
renderCards();
updateCartUI();
</script>
</body>
</html>
